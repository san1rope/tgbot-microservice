mtprotosender.py:234 #INFO     [2026-01-19 02:02:17,511] - telethon.network.mtprotosender - 0| Connecting to 149.154.171.5:443/TcpFull...
mtprotosender.py:285 #INFO     [2026-01-19 02:02:17,697] - telethon.network.mtprotosender - 0| Connection to 149.154.171.5:443/TcpFull complete!
utils.py:63 #INFO     [2026-01-19 02:02:18,881] - root - 0| Client has been connected!
utils.py:63 #INFO     [2026-01-19 02:02:18,881] - root - 0| Redis has been initialized!
utils.py:63 #INFO     [2026-01-19 02:02:18,881] - root - 0| Prepare to load data in redis...
utils.py:63 #INFO     [2026-01-19 02:02:18,882] - root - 0| Loading messages data from small groups...
utils.py:63 #INFO     [2026-01-19 02:02:21,789] - root - 0| Data from small groups has been loaded!
utils.py:63 #INFO     [2026-01-19 02:02:21,790] - root - 0| Event handlers has been registered!
utils.py:63 #INFO     [2026-01-19 02:02:21,790] - root - 0| Queue worker has been started!
utils.py:63 #INFO     [2026-01-19 02:02:21,790] - root - 0| Kafka listener has been started!
subscription_state.py:110 #INFO     [2026-01-19 02:02:21,790] - aiokafka.consumer.subscription_state - 0| Updating subscribed topics to: frozenset({'messages'})
group_coordinator.py:594 #INFO     [2026-01-19 02:02:21,846] - aiokafka.consumer.group_coordinator - 0| Discovered coordinator 1 for group demo-group
group_coordinator.py:415 #INFO     [2026-01-19 02:02:21,846] - aiokafka.consumer.group_coordinator - 0| Revoking previously assigned partitions set() for group demo-group
group_coordinator.py:1281 #INFO     [2026-01-19 02:02:21,846] - aiokafka.consumer.group_coordinator - 0| (Re-)joining group demo-group
group_coordinator.py:1360 #INFO     [2026-01-19 02:02:25,134] - aiokafka.consumer.group_coordinator - 0| Joined group 'demo-group' (generation 51) with member_id aiokafka-0.12.0-0de5566c-be30-47a0-9248-c61e4abde528
group_coordinator.py:1368 #INFO     [2026-01-19 02:02:25,134] - aiokafka.consumer.group_coordinator - 0| Elected group leader -- performing partition assignments using roundrobin
group_coordinator.py:1519 #INFO     [2026-01-19 02:02:25,163] - aiokafka.consumer.group_coordinator - 0| Successfully synced group demo-group with generation 51
group_coordinator.py:506 #INFO     [2026-01-19 02:02:25,164] - aiokafka.consumer.group_coordinator - 0| Setting newly assigned partitions {TopicPartition(topic='messages', partition=0)} for group demo-group
events_catcher.py:31 #INFO     [2026-01-19 02:02:41,826] - root - 0| New event: NewMessage
utils.py:63 #INFO     [2026-01-19 02:02:42,656] - root - 0| Event: Message Created
Request | 200 | https://tenerife.chat/chat/webhook/telegram/create 
<pre>{
  "type": "message_created",
  "chat_id": -5180718767,
  "message_id": 95,
  "text": "Ñ‹",
  "message_type": 1,
  "topic_id": null,
  "sender": {
    "id": 1643710214,
    "first_name": "san1rope",
    "username": "san1rope",
    "language_code": null
  },
  "chat_info": {
    "title": "qwkdlqwd",
    "username": null,
    "type": "chat",
    "is_forum": false,
    "member_count": 2
  },
  "timestamp": "2026-01-19T00:02:43Z",
  "media": null
}</pre>
group_coordinator.py:390 #INFO     [2026-01-19 02:03:15,000] - aiokafka.consumer.group_coordinator - 0| LeaveGroup request succeeded
base_events.py:1758 #ERROR    [2026-01-19 02:03:15,002] - asyncio - 0| Task exception was never retrieved
future: <Task finished name='Task-12' coro=<KafkaInterface.start_polling() done, defined at C:\Users\valet\PycharmProjects\tgbot-microservice\app\api\kafka.py:68> exception=2 validation errors for SendMessageRequest
topic_id
  Input should be a valid integer [type=int_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/int_type
reply_to_message_id
  Input should be a valid integer [type=int_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/int_type>
Traceback (most recent call last):
  File "C:\Users\valet\PycharmProjects\tgbot-microservice\app\api\kafka.py", line 86, in start_polling
    payload_coroutine = await cls.coroutine_from_payload(json.loads(msg.value))
  File "C:\Users\valet\PycharmProjects\tgbot-microservice\app\api\kafka.py", line 21, in coroutine_from_payload
    return UserActions.send_message(SendMessageRequest(**payload))
  File "C:\Users\valet\PycharmProjects\tgbot-microservice\.venv\lib\site-packages\pydantic\main.py", line 253, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 2 validation errors for SendMessageRequest
topic_id
  Input should be a valid integer [type=int_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/int_type
reply_to_message_id
  Input should be a valid integer [type=int_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/int_type
mtprotosender.py:325 #INFO     [2026-01-19 02:03:23,911] - telethon.network.mtprotosender - 0| Disconnecting from 149.154.171.5:443/TcpFull...
mtprotosender.py:345 #INFO     [2026-01-19 02:03:23,911] - telethon.network.mtprotosender - 0| Disconnection from 149.154.171.5:443/TcpFull complete!
