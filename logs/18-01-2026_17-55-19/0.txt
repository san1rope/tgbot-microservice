mtprotosender.py:234 #INFO     [2026-01-18 17:55:19,575] - telethon.network.mtprotosender - 0| Connecting to 149.154.171.5:443/TcpFull...
mtprotosender.py:285 #INFO     [2026-01-18 17:55:19,762] - telethon.network.mtprotosender - 0| Connection to 149.154.171.5:443/TcpFull complete!
utils.py:63 #INFO     [2026-01-18 17:55:21,034] - root - 0| Client has been connected!
utils.py:63 #INFO     [2026-01-18 17:55:21,035] - root - 0| Redis has been initialized!
utils.py:63 #INFO     [2026-01-18 17:55:21,035] - root - 0| Prepare to load data in redis...
utils.py:63 #INFO     [2026-01-18 17:55:21,035] - root - 0| Loading messages data from small groups...
utils.py:63 #INFO     [2026-01-18 17:55:23,970] - root - 0| Data from small groups has been loaded!
utils.py:63 #INFO     [2026-01-18 17:55:23,971] - root - 0| Event handlers has been registered!
utils.py:63 #INFO     [2026-01-18 17:55:23,971] - root - 0| Queue worker has been started!
utils.py:63 #INFO     [2026-01-18 17:55:23,971] - root - 0| Kafka listener has been started!
subscription_state.py:110 #INFO     [2026-01-18 17:55:23,972] - aiokafka.consumer.subscription_state - 0| Updating subscribed topics to: frozenset({'messages'})
group_coordinator.py:594 #INFO     [2026-01-18 17:55:24,012] - aiokafka.consumer.group_coordinator - 0| Discovered coordinator 1 for group demo-group
group_coordinator.py:415 #INFO     [2026-01-18 17:55:24,012] - aiokafka.consumer.group_coordinator - 0| Revoking previously assigned partitions set() for group demo-group
group_coordinator.py:1281 #INFO     [2026-01-18 17:55:24,012] - aiokafka.consumer.group_coordinator - 0| (Re-)joining group demo-group
group_coordinator.py:1360 #INFO     [2026-01-18 17:55:27,288] - aiokafka.consumer.group_coordinator - 0| Joined group 'demo-group' (generation 49) with member_id aiokafka-0.12.0-8ddf44a4-1dff-41f4-8515-63d93b64f8aa
group_coordinator.py:1368 #INFO     [2026-01-18 17:55:27,289] - aiokafka.consumer.group_coordinator - 0| Elected group leader -- performing partition assignments using roundrobin
group_coordinator.py:1519 #INFO     [2026-01-18 17:55:27,299] - aiokafka.consumer.group_coordinator - 0| Successfully synced group demo-group with generation 49
group_coordinator.py:506 #INFO     [2026-01-18 17:55:27,299] - aiokafka.consumer.group_coordinator - 0| Setting newly assigned partitions {TopicPartition(topic='messages', partition=0)} for group demo-group
group_coordinator.py:390 #INFO     [2026-01-18 18:02:56,098] - aiokafka.consumer.group_coordinator - 0| LeaveGroup request succeeded
base_events.py:1758 #ERROR    [2026-01-18 18:02:56,099] - asyncio - 0| Task exception was never retrieved
future: <Task finished name='Task-12' coro=<KafkaInterface.start_polling() done, defined at C:\Users\valet\PycharmProjects\tgbot-microservice\app\api\kafka.py:68> exception=2 validation errors for SendMessageRequest
topic_id
  Input should be a valid integer [type=int_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/int_type
reply_to_message_id
  Input should be a valid integer [type=int_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/int_type>
Traceback (most recent call last):
  File "C:\Users\valet\PycharmProjects\tgbot-microservice\app\api\kafka.py", line 86, in start_polling
    payload_coroutine = await cls.coroutine_from_payload(json.loads(msg.value))
  File "C:\Users\valet\PycharmProjects\tgbot-microservice\app\api\kafka.py", line 21, in coroutine_from_payload
    return UserActions.send_message(SendMessageRequest(**payload))
  File "C:\Users\valet\PycharmProjects\tgbot-microservice\.venv\lib\site-packages\pydantic\main.py", line 253, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 2 validation errors for SendMessageRequest
topic_id
  Input should be a valid integer [type=int_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/int_type
reply_to_message_id
  Input should be a valid integer [type=int_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/int_type
mtprotosender.py:325 #INFO     [2026-01-18 18:03:04,770] - telethon.network.mtprotosender - 0| Disconnecting from 149.154.171.5:443/TcpFull...
mtprotosender.py:345 #INFO     [2026-01-18 18:03:04,770] - telethon.network.mtprotosender - 0| Disconnection from 149.154.171.5:443/TcpFull complete!
