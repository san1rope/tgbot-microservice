mtprotosender.py:234 #INFO     [2026-01-18 17:43:30,720] - telethon.network.mtprotosender - 0| Connecting to 149.154.171.5:443/TcpFull...
mtprotosender.py:285 #INFO     [2026-01-18 17:43:30,907] - telethon.network.mtprotosender - 0| Connection to 149.154.171.5:443/TcpFull complete!
utils.py:63 #INFO     [2026-01-18 17:43:32,109] - root - 0| Client has been connected!
utils.py:63 #INFO     [2026-01-18 17:43:32,110] - root - 0| Redis has been initialized!
utils.py:63 #INFO     [2026-01-18 17:43:32,110] - root - 0| Prepare to load data in redis...
utils.py:63 #INFO     [2026-01-18 17:43:32,110] - root - 0| Loading messages data from small groups...
utils.py:63 #INFO     [2026-01-18 17:43:35,184] - root - 0| Data from small groups has been loaded!
utils.py:63 #INFO     [2026-01-18 17:43:35,185] - root - 0| Event handlers has been registered!
utils.py:63 #INFO     [2026-01-18 17:43:35,185] - root - 0| Queue worker has been started!
utils.py:63 #INFO     [2026-01-18 17:43:35,185] - root - 0| Kafka listener has been started!
subscription_state.py:110 #INFO     [2026-01-18 17:43:35,186] - aiokafka.consumer.subscription_state - 0| Updating subscribed topics to: frozenset({'messages'})
group_coordinator.py:594 #INFO     [2026-01-18 17:43:35,240] - aiokafka.consumer.group_coordinator - 0| Discovered coordinator 1 for group demo-group
group_coordinator.py:415 #INFO     [2026-01-18 17:43:35,240] - aiokafka.consumer.group_coordinator - 0| Revoking previously assigned partitions set() for group demo-group
group_coordinator.py:1281 #INFO     [2026-01-18 17:43:35,240] - aiokafka.consumer.group_coordinator - 0| (Re-)joining group demo-group
group_coordinator.py:1360 #INFO     [2026-01-18 17:43:38,531] - aiokafka.consumer.group_coordinator - 0| Joined group 'demo-group' (generation 47) with member_id aiokafka-0.12.0-1257bfcb-c047-49b3-bcb4-e104f3990e26
group_coordinator.py:1368 #INFO     [2026-01-18 17:43:38,531] - aiokafka.consumer.group_coordinator - 0| Elected group leader -- performing partition assignments using roundrobin
group_coordinator.py:1519 #INFO     [2026-01-18 17:43:38,560] - aiokafka.consumer.group_coordinator - 0| Successfully synced group demo-group with generation 47
group_coordinator.py:506 #INFO     [2026-01-18 17:43:38,560] - aiokafka.consumer.group_coordinator - 0| Setting newly assigned partitions {TopicPartition(topic='messages', partition=0)} for group demo-group
group_coordinator.py:390 #INFO     [2026-01-18 17:43:38,628] - aiokafka.consumer.group_coordinator - 0| LeaveGroup request succeeded
base_events.py:1758 #ERROR    [2026-01-18 17:43:38,629] - asyncio - 0| Task exception was never retrieved
future: <Task finished name='Task-12' coro=<KafkaInterface.start_polling() done, defined at C:\Users\valet\PycharmProjects\tgbot-microservice\app\api\kafka.py:68> exception=AttributeError("'str' object has no attribute 'pop'")>
Traceback (most recent call last):
  File "C:\Users\valet\PycharmProjects\tgbot-microservice\app\api\kafka.py", line 86, in start_polling
    payload_coroutine = await cls.coroutine_from_payload(json.loads(msg.value))
  File "C:\Users\valet\PycharmProjects\tgbot-microservice\app\api\kafka.py", line 19, in coroutine_from_payload
    rt.pop("request_type")
AttributeError: 'str' object has no attribute 'pop'
mtprotosender.py:325 #INFO     [2026-01-18 17:52:03,346] - telethon.network.mtprotosender - 0| Disconnecting from 149.154.171.5:443/TcpFull...
mtprotosender.py:345 #INFO     [2026-01-18 17:52:03,347] - telethon.network.mtprotosender - 0| Disconnection from 149.154.171.5:443/TcpFull complete!
