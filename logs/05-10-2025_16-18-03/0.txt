mtprotosender.py:228 #INFO     [2025-10-05 16:18:03,886] - telethon.network.mtprotosender - 0| Connecting to 149.154.167.51:443/TcpFull...
mtprotosender.py:279 #INFO     [2025-10-05 16:18:03,921] - telethon.network.mtprotosender - 0| Connection to 149.154.167.51:443/TcpFull complete!
handlers.py:16 #INFO     [2025-10-05 16:18:09,602] - root - 0| Handler called. NewMessage. type = <class 'telethon.tl.patched.Message'>
updates.py:590 #ERROR    [2025-10-05 16:18:10,263] - telethon.client.updates - 0| Unhandled exception on event_new_message
Traceback (most recent call last):
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\.venv\lib\site-packages\telethon\client\updates.py", line 574, in _dispatch_update
    await callback(event)
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\app\handlers.py", line 28, in event_new_message
    await Config.REDIS.set(f"msg:{msg_obj.id}", chat_id)
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\.venv\lib\site-packages\redis\asyncio\client.py", line 677, in execute_command
    return await conn.retry.call_with_retry(
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\.venv\lib\site-packages\redis\asyncio\retry.py", line 50, in call_with_retry
    return await do()
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\.venv\lib\site-packages\redis\asyncio\client.py", line 652, in _send_command_parse_response
    return await self.parse_response(conn, command_name, **options)
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\.venv\lib\site-packages\redis\asyncio\client.py", line 698, in parse_response
    response = await connection.read_response()
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\.venv\lib\site-packages\redis\asyncio\connection.py", line 627, in read_response
    raise response from None
redis.exceptions.ResponseError: MISCONF Redis is configured to save RDB snapshots, but is currently not able to persist on disk. Commands that may modify the data set are disabled. Please check Redis logs for details about the error.
handlers.py:16 #INFO     [2025-10-05 16:18:30,372] - root - 0| Handler called. NewMessage. type = <class 'telethon.tl.patched.Message'>
handlers.py:16 #INFO     [2025-10-05 16:18:30,374] - root - 0| Handler called. NewMessage. type = <class 'telethon.tl.patched.Message'>
handlers.py:16 #INFO     [2025-10-05 16:18:30,374] - root - 0| Handler called. NewMessage. type = <class 'telethon.tl.patched.Message'>
updates.py:590 #ERROR    [2025-10-05 16:18:30,516] - telethon.client.updates - 0| Unhandled exception on event_new_message
Traceback (most recent call last):
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\.venv\lib\site-packages\telethon\client\updates.py", line 574, in _dispatch_update
    await callback(event)
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\app\handlers.py", line 28, in event_new_message
    await Config.REDIS.set(f"msg:{msg_obj.id}", chat_id)
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\.venv\lib\site-packages\redis\asyncio\client.py", line 677, in execute_command
    return await conn.retry.call_with_retry(
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\.venv\lib\site-packages\redis\asyncio\retry.py", line 50, in call_with_retry
    return await do()
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\.venv\lib\site-packages\redis\asyncio\client.py", line 652, in _send_command_parse_response
    return await self.parse_response(conn, command_name, **options)
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\.venv\lib\site-packages\redis\asyncio\client.py", line 698, in parse_response
    response = await connection.read_response()
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\.venv\lib\site-packages\redis\asyncio\connection.py", line 627, in read_response
    raise response from None
redis.exceptions.ResponseError: MISCONF Redis is configured to save RDB snapshots, but is currently not able to persist on disk. Commands that may modify the data set are disabled. Please check Redis logs for details about the error.
updates.py:590 #ERROR    [2025-10-05 16:18:30,535] - telethon.client.updates - 0| Unhandled exception on event_new_message
Traceback (most recent call last):
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\.venv\lib\site-packages\telethon\client\updates.py", line 574, in _dispatch_update
    await callback(event)
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\app\handlers.py", line 28, in event_new_message
    await Config.REDIS.set(f"msg:{msg_obj.id}", chat_id)
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\.venv\lib\site-packages\redis\asyncio\client.py", line 677, in execute_command
    return await conn.retry.call_with_retry(
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\.venv\lib\site-packages\redis\asyncio\retry.py", line 50, in call_with_retry
    return await do()
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\.venv\lib\site-packages\redis\asyncio\client.py", line 652, in _send_command_parse_response
    return await self.parse_response(conn, command_name, **options)
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\.venv\lib\site-packages\redis\asyncio\client.py", line 698, in parse_response
    response = await connection.read_response()
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\.venv\lib\site-packages\redis\asyncio\connection.py", line 627, in read_response
    raise response from None
redis.exceptions.ResponseError: MISCONF Redis is configured to save RDB snapshots, but is currently not able to persist on disk. Commands that may modify the data set are disabled. Please check Redis logs for details about the error.
updates.py:590 #ERROR    [2025-10-05 16:18:30,557] - telethon.client.updates - 0| Unhandled exception on event_new_message
Traceback (most recent call last):
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\.venv\lib\site-packages\telethon\client\updates.py", line 574, in _dispatch_update
    await callback(event)
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\app\handlers.py", line 28, in event_new_message
    await Config.REDIS.set(f"msg:{msg_obj.id}", chat_id)
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\.venv\lib\site-packages\redis\asyncio\client.py", line 677, in execute_command
    return await conn.retry.call_with_retry(
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\.venv\lib\site-packages\redis\asyncio\retry.py", line 50, in call_with_retry
    return await do()
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\.venv\lib\site-packages\redis\asyncio\client.py", line 652, in _send_command_parse_response
    return await self.parse_response(conn, command_name, **options)
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\.venv\lib\site-packages\redis\asyncio\client.py", line 698, in parse_response
    response = await connection.read_response()
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\.venv\lib\site-packages\redis\asyncio\connection.py", line 627, in read_response
    raise response from None
redis.exceptions.ResponseError: MISCONF Redis is configured to save RDB snapshots, but is currently not able to persist on disk. Commands that may modify the data set are disabled. Please check Redis logs for details about the error.
handlers.py:16 #INFO     [2025-10-05 16:18:31,869] - root - 0| Handler called. NewMessage. type = <class 'telethon.tl.patched.Message'>
updates.py:590 #ERROR    [2025-10-05 16:18:32,177] - telethon.client.updates - 0| Unhandled exception on event_new_message
Traceback (most recent call last):
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\.venv\lib\site-packages\telethon\client\updates.py", line 574, in _dispatch_update
    await callback(event)
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\app\handlers.py", line 28, in event_new_message
    await Config.REDIS.set(f"msg:{msg_obj.id}", chat_id)
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\.venv\lib\site-packages\redis\asyncio\client.py", line 677, in execute_command
    return await conn.retry.call_with_retry(
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\.venv\lib\site-packages\redis\asyncio\retry.py", line 50, in call_with_retry
    return await do()
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\.venv\lib\site-packages\redis\asyncio\client.py", line 652, in _send_command_parse_response
    return await self.parse_response(conn, command_name, **options)
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\.venv\lib\site-packages\redis\asyncio\client.py", line 698, in parse_response
    response = await connection.read_response()
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\.venv\lib\site-packages\redis\asyncio\connection.py", line 627, in read_response
    raise response from None
redis.exceptions.ResponseError: MISCONF Redis is configured to save RDB snapshots, but is currently not able to persist on disk. Commands that may modify the data set are disabled. Please check Redis logs for details about the error.
updates.py:443 #INFO     [2025-10-05 16:18:39,103] - telethon.client.updates - 0| Got difference for channel 1680980716 updates
handlers.py:16 #INFO     [2025-10-05 16:18:39,103] - root - 0| Handler called. NewMessage. type = <class 'telethon.tl.patched.Message'>
users.py:122 #INFO     [2025-10-05 16:18:39,146] - telethon.client.users - 0| Sleeping for 3s (0:00:03) on GetFullChannelRequest flood wait
updates.py:590 #ERROR    [2025-10-05 16:18:42,251] - telethon.client.updates - 0| Unhandled exception on event_new_message
Traceback (most recent call last):
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\.venv\lib\site-packages\telethon\client\updates.py", line 574, in _dispatch_update
    await callback(event)
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\app\handlers.py", line 28, in event_new_message
    await Config.REDIS.set(f"msg:{msg_obj.id}", chat_id)
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\.venv\lib\site-packages\redis\asyncio\client.py", line 677, in execute_command
    return await conn.retry.call_with_retry(
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\.venv\lib\site-packages\redis\asyncio\retry.py", line 50, in call_with_retry
    return await do()
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\.venv\lib\site-packages\redis\asyncio\client.py", line 652, in _send_command_parse_response
    return await self.parse_response(conn, command_name, **options)
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\.venv\lib\site-packages\redis\asyncio\client.py", line 698, in parse_response
    response = await connection.read_response()
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\.venv\lib\site-packages\redis\asyncio\connection.py", line 627, in read_response
    raise response from None
redis.exceptions.ResponseError: MISCONF Redis is configured to save RDB snapshots, but is currently not able to persist on disk. Commands that may modify the data set are disabled. Please check Redis logs for details about the error.
handlers.py:16 #INFO     [2025-10-05 16:18:45,404] - root - 0| Handler called. NewMessage. type = <class 'telethon.tl.patched.Message'>
handlers.py:16 #INFO     [2025-10-05 16:18:45,406] - root - 0| Handler called. NewMessage. type = <class 'telethon.tl.patched.Message'>
handlers.py:16 #INFO     [2025-10-05 16:18:45,407] - root - 0| Handler called. NewMessage. type = <class 'telethon.tl.patched.Message'>
updates.py:590 #ERROR    [2025-10-05 16:18:45,458] - telethon.client.updates - 0| Unhandled exception on event_new_message
Traceback (most recent call last):
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\.venv\lib\site-packages\telethon\client\updates.py", line 574, in _dispatch_update
    await callback(event)
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\app\handlers.py", line 28, in event_new_message
    await Config.REDIS.set(f"msg:{msg_obj.id}", chat_id)
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\.venv\lib\site-packages\redis\asyncio\client.py", line 677, in execute_command
    return await conn.retry.call_with_retry(
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\.venv\lib\site-packages\redis\asyncio\retry.py", line 50, in call_with_retry
    return await do()
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\.venv\lib\site-packages\redis\asyncio\client.py", line 652, in _send_command_parse_response
    return await self.parse_response(conn, command_name, **options)
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\.venv\lib\site-packages\redis\asyncio\client.py", line 698, in parse_response
    response = await connection.read_response()
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\.venv\lib\site-packages\redis\asyncio\connection.py", line 627, in read_response
    raise response from None
redis.exceptions.ResponseError: MISCONF Redis is configured to save RDB snapshots, but is currently not able to persist on disk. Commands that may modify the data set are disabled. Please check Redis logs for details about the error.
updates.py:590 #ERROR    [2025-10-05 16:18:45,583] - telethon.client.updates - 0| Unhandled exception on event_new_message
Traceback (most recent call last):
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\.venv\lib\site-packages\telethon\client\updates.py", line 574, in _dispatch_update
    await callback(event)
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\app\handlers.py", line 28, in event_new_message
    await Config.REDIS.set(f"msg:{msg_obj.id}", chat_id)
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\.venv\lib\site-packages\redis\asyncio\client.py", line 677, in execute_command
    return await conn.retry.call_with_retry(
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\.venv\lib\site-packages\redis\asyncio\retry.py", line 50, in call_with_retry
    return await do()
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\.venv\lib\site-packages\redis\asyncio\client.py", line 652, in _send_command_parse_response
    return await self.parse_response(conn, command_name, **options)
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\.venv\lib\site-packages\redis\asyncio\client.py", line 698, in parse_response
    response = await connection.read_response()
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\.venv\lib\site-packages\redis\asyncio\connection.py", line 627, in read_response
    raise response from None
redis.exceptions.ResponseError: MISCONF Redis is configured to save RDB snapshots, but is currently not able to persist on disk. Commands that may modify the data set are disabled. Please check Redis logs for details about the error.
updates.py:590 #ERROR    [2025-10-05 16:18:45,584] - telethon.client.updates - 0| Unhandled exception on event_new_message
Traceback (most recent call last):
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\.venv\lib\site-packages\telethon\client\updates.py", line 574, in _dispatch_update
    await callback(event)
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\app\handlers.py", line 28, in event_new_message
    await Config.REDIS.set(f"msg:{msg_obj.id}", chat_id)
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\.venv\lib\site-packages\redis\asyncio\client.py", line 677, in execute_command
    return await conn.retry.call_with_retry(
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\.venv\lib\site-packages\redis\asyncio\retry.py", line 50, in call_with_retry
    return await do()
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\.venv\lib\site-packages\redis\asyncio\client.py", line 652, in _send_command_parse_response
    return await self.parse_response(conn, command_name, **options)
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\.venv\lib\site-packages\redis\asyncio\client.py", line 698, in parse_response
    response = await connection.read_response()
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\.venv\lib\site-packages\redis\asyncio\connection.py", line 627, in read_response
    raise response from None
redis.exceptions.ResponseError: MISCONF Redis is configured to save RDB snapshots, but is currently not able to persist on disk. Commands that may modify the data set are disabled. Please check Redis logs for details about the error.
handlers.py:16 #INFO     [2025-10-05 16:18:45,699] - root - 0| Handler called. NewMessage. type = <class 'telethon.tl.patched.Message'>
updates.py:590 #ERROR    [2025-10-05 16:18:45,750] - telethon.client.updates - 0| Unhandled exception on event_new_message
Traceback (most recent call last):
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\.venv\lib\site-packages\telethon\client\updates.py", line 574, in _dispatch_update
    await callback(event)
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\app\handlers.py", line 28, in event_new_message
    await Config.REDIS.set(f"msg:{msg_obj.id}", chat_id)
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\.venv\lib\site-packages\redis\asyncio\client.py", line 677, in execute_command
    return await conn.retry.call_with_retry(
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\.venv\lib\site-packages\redis\asyncio\retry.py", line 50, in call_with_retry
    return await do()
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\.venv\lib\site-packages\redis\asyncio\client.py", line 652, in _send_command_parse_response
    return await self.parse_response(conn, command_name, **options)
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\.venv\lib\site-packages\redis\asyncio\client.py", line 698, in parse_response
    response = await connection.read_response()
  File "C:\Users\Valentyn\PycharmProjects\tgbot-microservice\.venv\lib\site-packages\redis\asyncio\connection.py", line 627, in read_response
    raise response from None
redis.exceptions.ResponseError: MISCONF Redis is configured to save RDB snapshots, but is currently not able to persist on disk. Commands that may modify the data set are disabled. Please check Redis logs for details about the error.
mtprotosender.py:319 #INFO     [2025-10-05 16:19:01,729] - telethon.network.mtprotosender - 0| Disconnecting from 149.154.167.51:443/TcpFull...
mtprotosender.py:339 #INFO     [2025-10-05 16:19:01,729] - telethon.network.mtprotosender - 0| Disconnection from 149.154.167.51:443/TcpFull complete!
